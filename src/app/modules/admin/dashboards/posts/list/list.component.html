<div
  *ngIf="!createPost"
  class="absolute inset-0 flex flex-col min-w-0 overflow-y-auto"
  cdkScrollable
>
  <!-- Header -->
  <div
    class="relative flex-0 py-8 px-4 sm:p-16 overflow-hidden bg-gray-800 dark"
  >
    <!-- Background - @formatter:off -->
    <!-- Rings -->
    <svg
      class="absolute inset-0 pointer-events-none"
      viewBox="0 0 960 540"
      width="100%"
      height="100%"
      preserveAspectRatio="xMidYMax slice"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g
        class="text-gray-700 opacity-25"
        fill="none"
        stroke="currentColor"
        stroke-width="100"
      >
        <circle r="234" cx="196" cy="23"></circle>
        <circle r="234" cx="790" cy="491"></circle>
      </g>
    </svg>
    <!-- @formatter:on -->
    <div class="z-10 relative flex flex-col items-center">
      <h2 class="text-xl font-semibold">ANCODE</h2>
      <div
        class="mt-1 text-4xl sm:text-7xl font-extrabold tracking-tight leading-tight text-center"
      >
        Unleashing the Power of Words
      </div>
      <div
        class="max-w-2xl mt-6 sm:text-2xl text-center tracking-tight text-secondary"
      >
        Unlocking the Secrets to a Happy and Fulfilling Life: Insights and
        Inspiration for Personal Growth
      </div>
    </div>
  </div>
  <!-- Main -->
  <div class="flex flex-auto p-6 sm:p-10">
    <div class="flex flex-col flex-auto w-full max-w-xs sm:max-w-5xl mx-auto">
      <!--filters-->
      <div
        class="flex flex-col sm:flex-row items-center justify-between w-full max-w-xs sm:max-w-none"
      >
        <mat-form-field class=" w-full sm:w-36 ancode-mat-no-subscript">
          <mat-select
            [value]="'all'"
            (selectionChange)="filterByCategory($event)"
          >
            <mat-option [value]="'all'">All</mat-option>
            <ng-container
              *ngFor="let category of categories; trackBy: trackByFn"
            >
              <mat-option [value]="category.slug">{{
                category.title
              }}</mat-option>
            </ng-container>
          </mat-select>
        </mat-form-field>
        <mat-form-field
          class=" w-full sm:w-72 mt-4 sm:mt-0 sm:ml-4 ancode-mat-no-subscript" 
          [floatLabel]="'always'"
        >
          <mat-icon
            matPrefix
            class="icon-size-5"
            [svgIcon]="'heroicons_solid:search'"
          ></mat-icon>
          <input
            (input)="filterByQuery(query.value)"
            placeholder="Search by title or description"
            matInput
            #query
          />
        </mat-form-field>
        <!-- Add product button -->
        <button
          class="mt-8 sm:mt-0 sm:ml-auto"
          mat-flat-button
          [color]="'primary'"
          (click)="togglePostMode()"
        >
          <mat-icon [svgIcon]="'heroicons_outline:plus'"></mat-icon>
          <span class="ml-2 mr-1">New post</span>
        </button>
      </div>
      <!-- Posts -->
      <ng-container *ngIf="this.filteredPosts.length; else noPosts">
        <div
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mt-8 sm:mt-10"
        >
          <ng-container *ngFor="let post of filteredPosts; trackBy: trackByFn">
            <!-- Post -->
            <div
              class="flex flex-col h-auto shadow rounded-2xl overflow-hidden bg-card"
            >
              <div class="flex flex-col p-6">
                <div class="flex items-center justify-between">
                  <!-- Post category -->
                  <ng-container
                    *ngIf="
                      post.category!
                        | ancodeFindByKey : 'slug' : categories as category
                    "
                  >
                    <div
                      class="py-0.5 px-3 rounded-full text-sm font-semibold"
                      [ngClass]="{
                        'text-blue-800 bg-blue-100 dark:text-blue-50 dark:bg-blue-500':
                          category.slug === 'web',
                        'text-green-800 bg-green-100 dark:text-green-50 dark:bg-green-500':
                          category.slug === 'android',
                        'text-pink-800 bg-pink-100 dark:text-pink-50 dark:bg-pink-500':
                          category.slug === 'health',
                        'text-amber-800 bg-amber-100 dark:text-amber-50 dark:bg-amber-500':
                          category.slug === 'lifestyle',
                        'text-yellow-800 bg-yellow-100 dark:text-yellow-50 dark:bg-yellow-500':
                          category.slug === 'science'
                      }"
                    >
                      {{ category.title }}
                    </div>
                  </ng-container>
                  <!-- Completed at least once -->
                  <div class="flex items-center">
                    <ng-container *ngIf="post.featured">
                      <mat-icon
                        class="icon-size-5 text-green-600"
                        [svgIcon]="'heroicons_solid:badge-check'"
                        [matTooltip]="'Post is availabe to public'"
                      ></mat-icon>
                    </ng-container>
                  </div>
                </div>
                <!-- Post title & description -->
                <div class="mt-4 text-lg font-medium">{{ post.title }}</div>
                <div class="w-12 h-1 my-6 border-t-2"></div>
                <!-- Post time -->
                <div class="flex items-center leading-5 text-md text-secondary">
                  <mat-icon
                    class="icon-size-5 text-hint"
                    [svgIcon]="'heroicons_solid:clock'"
                  ></mat-icon>
                  <div class="ml-1.5">{{ post.updatedAt }}</div>
                </div>
                <div
                  class="flex items-center mt-2 leading-5 text-md text-secondary"
                >
                  <mat-icon
                    class="icon-size-5 text-hint"
                    [svgIcon]="'heroicons_solid:pencil'"
                  ></mat-icon>
                  <div class="ml-1.5">{{ post.author }}</div>
                </div>
              </div>
              <!-- Footer -->
              <div class="flex flex-col w-full">
                <!-- Post launch button -->
                <div
                  class="px-6 py-4 text-right bg-gray-50 dark:bg-transparent"
                >
                  <button mat-stroked-button [routerLink]="[post.id]">
                    <span class="inline-flex items-center">
                      <!-- Started -->

                      <span>View Post</span>

                      <mat-icon
                        class="ml-1.5 icon-size-5"
                        [svgIcon]="'heroicons_solid:arrow-sm-right'"
                      ></mat-icon>
                    </span>
                  </button>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </ng-container>

      <!-- No posts -->
      <ng-template #noPosts>
        <div
          class="flex flex-auto flex-col items-center justify-center bg-gray-100 dark:bg-transparent"
        >
          <mat-icon class="icon-size-24"></mat-icon>
          <div
            class="mt-6 text-2xl font-semibold tracking-tight text-secondary"
          >
            No posts found!
          </div>
        </div>
      </ng-template>
    </div>
  </div>
</div>

<div
  *ngIf="createPost"
  class="absolute inset-0 flex flex-col min-w-0 overflow-y-auto"
>
  <div class="flex flex-col items-start p-8 border-b">
    <!-- Back to postlist -->
    <a
      class="inline-flex items-center leading-6 text-primary hover:underline cursor-pointer"
      (click)="togglePostMode()"
    >
      <span class="inline-flex items-center">
        <mat-icon
          class="icon-size-5 text-current"
          [svgIcon]="'heroicons_solid:arrow-sm-left'"
        ></mat-icon>
        <span class="ml-1.5 font-medium leading-5">Back to Post list</span>
      </span>
    </a>
  </div>
  <div class="flex-auto overflow-y-auto">
    <form [formGroup]="postForm">
      <div
        class="mx-auto prose prose-sm lg:max-w-5xl sm:max-w-3xl sm:my-2 lg:mt-4 p-6 sm:p-10 sm:py-12 rounded-2xl shadow overflow-hidden bg-card"
      >
        <!-- Title -->
        <mat-form-field class="w-full">
          <mat-label>Post Title</mat-label>
          <textarea
            matInput
            [formControlName]="'title'"
            [spellcheck]="false"
            cdkTextareaAutosize
          ></textarea>
          <mat-error *ngIf="postForm.get('title')?.hasError('required')">
            Please enter the post title
        </mat-error>
        </mat-form-field>
        <quill-editor
          class="mt-2 ancode-large-editor"
          [formControlName]="'description'"
          [modules]="quillModules"
        ></quill-editor>

        <div
          class="flex self-start py-2 overflow-hidden items-center justify-center"
        >
          <mat-form-field class="w-full ">
            <mat-label>Author & Category</mat-label>
            <textarea
              matInput
              [formControlName]="'author'"
              [spellcheck]="false"
              cdkTextareaAutosize
            ></textarea>
            <div class="flex items-center cursor-pointer"  matRipple
          [matMenuTriggerFor]="projectsMenu">
            <div
              class="overflow-hidden py-0.5 px-3 rounded-full text-sm font-semibold"
              [ngClass]="{
                'text-blue-800 bg-blue-100 dark:text-blue-50 dark:bg-blue-500':
                  selectedCategory === 'web',
                'text-green-800 bg-green-100 dark:text-green-50 dark:bg-green-500':
                  selectedCategory === 'android',
                'text-pink-800 bg-pink-100 dark:text-pink-50 dark:bg-pink-500':
                  selectedCategory === 'health',
                'text-amber-800 bg-amber-100 dark:text-amber-50 dark:bg-amber-500':
                  selectedCategory === 'lifestyle',
                'text-yellow-800 bg-yellow-100 dark:text-yellow-50 dark:bg-yellow-500':
                  selectedCategory === 'science'
              }"
            >
              <div class="font-medium leading-6 truncate">
                {{ selectedCategory }}
              </div>
            </div>
          </div>
          <mat-menu #projectsMenu="matMenu">
            <button
              mat-menu-item
              *ngFor="let category of categories"
              (click)="selectCategory(category.slug!)"
            >
              {{ category.title }}
            </button>
          </mat-menu>
            <mat-error *ngIf="postForm.get('author')?.hasError('required')">
              Please enter the author name and select a category
          </mat-error>
          </mat-form-field>
          
        </div>
        <div
          class="flex items-center mt-10 -mx-6 sm:-mx-12 py-4 pr-4 pl-1 sm:pr-12 sm:pl-7 border-t bg-gray-50 dark:bg-transparent"
        >
          <!-- Cancel -->
          <button class="ml-auto" mat-button [matTooltip]="'Cancel'">
            Cancel
          </button>
          <!-- Save -->
          <button
            class="ml-2"
            mat-flat-button
            [color]="'primary'"
            [matTooltip]="'Save'"
            (click)="publishPost()"
          >
            Publish
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
